
typedef unsigned long u_int32_t;
typedef unsigned long long u_int64_t;
/*
#include <sys/bitypes.h>
*/

/* need to select better names - a1 */

/* u_char s[4] -> u_int32_t */
#define s2l(c,l)        (l =((u_int32_t)(*((c)++)))     , \
                         l|=((u_int32_t)(*((c)++)))<< 8L, \
                         l|=((u_int32_t)(*((c)++)))<<16L, \
                         l|=((u_int32_t)(*((c)++)))<<24L)

/* u_int32_t -> u_char s[4] */
#define l2s(l,c)        (*((c)++)=(u_char)(((l)     )&0xff), \
                         *((c)++)=(u_char)(((l)>> 8L)&0xff), \
                         *((c)++)=(u_char)(((l)>>16L)&0xff), \
                         *((c)++)=(u_char)(((l)>>24L)&0xff))


/* u_char s[8] -> u_int64_t */
#define s2ll(c,ll)      (ll =((u_int64_t)(*((c)++)))<<32L, \
                         ll|=((u_int64_t)(*((c)++)))<<40L, \
                         ll|=((u_int64_t)(*((c)++)))<<48L, \
                         ll|=((u_int64_t)(*((c)++)))<<56L, \
                         ll|=((u_int64_t)(*((c)++)))     , \
                         ll|=((u_int64_t)(*((c)++)))<< 8L, \
                         ll|=((u_int64_t)(*((c)++)))<<16L, \
                         ll|=((u_int64_t)(*((c)++)))<<24L)

/* u_int64_t -> u_char s[8] */
#define ll2s(ll,c)      (*((c)++)=(u_char)(((ll)>>32L)&0xff), \
                         *((c)++)=(u_char)(((ll)>>40L)&0xff), \
                         *((c)++)=(u_char)(((ll)>>48L)&0xff), \
                         *((c)++)=(u_char)(((ll)>>56L)&0xff), \
                         *((c)++)=(u_char)(((ll)     )&0xff), \
                         *((c)++)=(u_char)(((ll)>> 8L)&0xff), \
                         *((c)++)=(u_char)(((ll)>>16L)&0xff), \
                         *((c)++)=(u_char)(((ll)>>24L)&0xff))

/* u_int32_t, u_int32_t -> u_int64_t */
#define ll2ll(l1,l2,ll)	(ll =((u_int64_t)(l1))<<32L, \
			 ll|=((u_int64_t)(l2)))

/* u_int64_t -> u_int32_t, u_int32_t */
#define ll_from_ll(ll,l1,l2) (l2=((u_int32_t)(((ll)     )&0xffffffffLL)), \
			      l1=((u_int32_t)(((ll)>>32L)&0xffffffffLL)))

/* lisp anyone? */
/* char hex[8] -> u_int32_t */
#define h2l(h,l) \
 (l = (((u_int32_t)(((h)[0]<58)?(((h)[0]-48)*16):(((h)[0]-55)*16)) \
   + (((h)[1]<58)?((h)[1]-48):((h)[1]-55)))     ), \
  l|= (((u_int32_t)(((h)[2]<58)?(((h)[2]-48)*16):(((h)[2]-55)*16)) \
   + (((h)[3]<58)?((h)[3]-48):((h)[3]-55)))<< 8L), \
  l|= (((u_int32_t)(((h)[4]<58)?(((h)[4]-48)*16):(((h)[4]-55)*16)) \
   + (((h)[5]<58)?((h)[5]-48):((h)[5]-55)))<<16L), \
  l|= (((u_int32_t)(((h)[6]<58)?(((h)[6]-48)*16):(((h)[6]-55)*16)) \
   + (((h)[7]<58)?((h)[7]-48):((h)[7]-55)))<<24L))

/* u_int32_t -> char[8] */
#define l2h(l,h) \
  ((h)[0]=(((l)     )&0xff), \
   (h)[1]=((h)[0]%16), (h)[1]=(((h)[1]<10)?((h)[1]+48):((h)[1]+55)), \
   (h)[0]=((h)[0]/16), (h)[0]=(((h)[0]<10)?((h)[0]+48):((h)[0]+55)), \
   (h)[2]=(((l)>> 8L)&0xff), \
   (h)[3]=((h)[2]%16), (h)[3]=(((h)[3]<10)?((h)[3]+48):((h)[3]+55)), \
   (h)[2]=((h)[2]/16), (h)[2]=(((h)[2]<10)?((h)[2]+48):((h)[2]+55)), \
   (h)[4]=(((l)>>16L)&0xff), \
   (h)[5]=((h)[4]%16), (h)[5]=(((h)[5]<10)?((h)[5]+48):((h)[5]+55)), \
   (h)[4]=((h)[4]/16), (h)[4]=(((h)[4]<10)?((h)[4]+48):((h)[4]+55)), \
   (h)[6]=(((l)>>24L)&0xff), \
   (h)[7]=((h)[6]%16), (h)[7]=(((h)[7]<10)?((h)[7]+48):((h)[7]+55)), \
   (h)[6]=((h)[6]/16), (h)[6]=(((h)[6]<10)?((h)[6]+48):((h)[6]+55)))

#define ll2p(ll,c)	(*((c)++)=(u_char)(((ll)>>32L)&0xff), \
                         *((c)++)=(u_char)(((ll)>>40L)&0xff), \
                         *((c)++)=(u_char)(((ll)>>48L)&0xff), \
                         *((c)++)=(u_char)(((ll)>>56L)&0xff), \
                         *((c)++)=(u_char)(((ll)     )&0xff), \
                         *((c)++)=(u_char)(((ll)>> 8L)&0xff), \
                         *((c)++)=(u_char)(((ll)>>16L)&0xff))


#define p2ll(c,l)	(l =((u_int64_t)(*((c)++)))<<32L, \
                         l|=((u_int64_t)(*((c)++)))<<40L, \
                         l|=((u_int64_t)(*((c)++)))<<48L, \
                         l|=((u_int64_t)(*((c)++)))<<56L, \
                         l|=((u_int64_t)(*((c)++)))     , \
                         l|=((u_int64_t)(*((c)++)))<< 8L, \
                         l|=((u_int64_t)(*((c)++)))<<16L)

